#!/bin/sh
# test1.tcl \
exec tclsh "$0" ${1+"$@"}

#初始化（读取lib 读取全局变量）
source "C:\\Users\\ban\\workspace\\Test\\init.tcl"

#读取CFG
proc GetCfg {} {
	set scrirptname [info script]
    regsub ".app.tcl" $scrirptname ".cfg" configFile
	#打开配置文件 
	set err [catch {set fileid [open $configFile r]} errMsg]
	if {$err==1} { 
	puts"errMsg:$errMsg"
	return 0
	} 
	set rowid 0
	seek $fileid 0 start
	set content [read $fileid]
	set line [split $content \n]    
	set data [lrange $line 1 end]  
	set cfgname [split [lindex $line 0] ,]
	set cfgnum [expr [llength $line]-1]   
	set datalength [llength [split [lindex $line 0] ,]]
	return [list $cfgnum $data $cfgname]
	}
	
	set Getall [GetCfg]
	set dataall [lindex [GetCfg] 1]
	set cfgnum [lindex [GetCfg] 0]
	set cfgname [lindex [GetCfg] 2]
	set i 0
	while {$i<$cfgnum} {
	set data [lindex $dataall $i]
		puts "222222222:$data"
		pause
	foreach ele $data {
		puts "111111:$ele"
		set b [lindex $cfgname $i]
		set c [lindex [split $ele ,] $i]		
		set cfg($b) $c
		puts "times:$i:cfg($b):[subst $cfg($b)]"
	}
	
#初始flag为1
set script_flag 1  

if { [catch { 
#预置条件
set TestCaseNo $cfg(TestCaseNo)
set TestCaseName $cfg(TestCaseName)
set no1 $cfg(no1)
	puts $no1
	
puts "TestCase:$TestCaseNo Start"
#测试执行

#结果判断
puts "TestCase:$TestCaseNo End"
} ErrorMessage ]} {
  set script_flag 0    
  puts ErrorMessage:$ErrorMessage
}
	
	#Print script report

	return [SetTestcaseResult $TestCaseNo [expr {$script_flag == 1 ? "PASS" : "FAIL"}] ]
		incr i
	}
